@model IEnumerable<MySpace.Models.Artiste>

@{
    ViewBag.Title = "Gallerie des Artistes";
}

<h2>Gallerie des Artistes</h2>
<div style="display: grid; grid-template-columns: 160px 60px 30px 30px 30px 30px 30px 30px">
    <input id="searchByName" type="search" style="width:150px; height:22px" class="form-control" placeholder="Recherche..." value="">
    <span id="doSearch" class="glyphicon glyphiconStyle glyphicon-search pointer" title="Recherche par mot-clées" style=""></span>
    <span id="sortNames" fieldtosort="names" class="sortArtists glyphicon glyphiconStyle glyphicon-user pointer" title="Trier par dates de création" style="color:dodgerblue !important"></span>
    <span id="sortVues" fieldtosort="vues" class="sortArtists glyphicon glyphiconStyle glyphicon-eye-open pointer" title="Trier par noms d'usager'" style="color: dodgerblue !important"></span>
    <span id="sortLikes" fieldtosort="likes" class="sortArtists glyphicon glyphiconStyle glyphicon-thumbs-up pointer" title="Trier par évaluations" style="color: dodgerblue !important"></span>
    <span></span>
    <span id="matrixView" class="glyphicon glyphiconStyle glyphicon-th pointer" title="Matrice" style="color:blue !important"></span>
</div>

<table class="ArtistListContainer" id="ArtistListContainer">

    @{Html.RenderAction("GetArtistsList", new { forceRefresh = true });}

</table>
@section Scripts {
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/bundles/partialRefresh")
    <script defer>

        let partialRefresh = new PartialRefresh("/Artistes/GetArtistsList", "ArtistListContainer", 5, postRefreshCallBacks);
        function postRefreshCallBacks() {
            $("#searchByName").change(function () {
                let url = /Artistes/ + "SetSearchArtistName?name=" + $("#searchByName").val();
                partialRefresh.command(url);
            });
            $("#searchByName").focus(function () {
                partialRefresh.pause();
                console.log("paused");
            });
            $("#searchByName").focusout(function () {
                partialRefresh.restart();
                console.log("restarted");
            });
            $('#doSearch').mouseup(function () {
                let url = /Artistes/ + "SetSearchArtistName?name=" + $("#searchByName").val();
                partialRefresh.command(url);
            });
            $(".sortArtists").click(function () {
                $(".sortArtists").css("color", "black");
                let url = /Artistes/ + "SortArtistsBy?fieldToSort=" + $(this).attr("fieldToSort");
                partialRefresh.command(url);
            });
            $("#listView").click(function () {
                let url = /Artistes/ + "ViewArtistLayout?list=false";
                partialRefresh.command(url);
            });
            $("#matrixView").click(function () {
                let url = /Artistes/ + "ViewArtistLayout?list=true";
                partialRefresh.command(url);
            });
        }

    </script>
    }